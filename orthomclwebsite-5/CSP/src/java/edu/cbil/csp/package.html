<BODY>
A Java version of CBIL's CSP. 

<BR>
<BR>

<B>INDEX</B>

<UL>
<LI><A HREF = "#background">Background</A></LI>
<LI><A HREF = "#overview">Overview</A></LI>
<LI><A HREF = "#examples">Example</A></LI>
<LI><A HREF = "#issues">Known Issues</A></LI>
</UL>

<B>Note to CBIL users</B>:<BR><BR>

To use this package and {@link cbil.csp.dialog}, include the file
<code>/usr/local/lib/java_classes/JCSP.jar</code> in your Java
<code>CLASSPATH</code>.<BR><BR>

<A NAME = "background"><b>BACKGROUND</b></A><BR><BR>

This package (and its sole subpackage, {@link cbil.csp.dialog}) form
the Java equivalent (more or less) of the CBIL Perl CSP package,
written by Jonathan Schug and Steve Fischer.  For those not in the
know, CSP is a Perl package for generating HTML pages and forms in a
principled manner.  Here are some of the things featured in the
original CSP:<p>

<UL>
<LI>An HTML-generating module that ensures that only
valid combinations of HTML elements and attributes are used.</LI>
<LI>Standard routines that generate page headers and footers,
helping to ensure a consistent look-and-feel on a web site.</LI>
<LI>A centralized repository for external references and hard-coded 
hyperlinks, simplifying maintenance.</LI>
<LI>A facility for defining abstract input dialogs or forms that
encourage the programmer to focus on <b>what</b> information is to
be collected from the user, rather than <b>how</b> the HTML form
should be formatted.</LI>
<LI>Automatic validation of user form input based on this abstract 
specification, prior to passing the validated input on to the 
appropriate CGI back-end.</LI>
</UL>

In case you were wondering, CSP stands for either "CBIL Style Policy" 
or "CBIL Style Police," depending on which section of the documentation
you believe.  See <A HREF = "http://agave.humgen.upenn.edu/csp/index.html">
here</A> for more information on CSP Classic.<p>

<BR>
<A NAME = "overview"><b>OVERVIEW</b></A><BR><BR>

The Java version of CSP shares the same basic design goals as the 
Perl version, and many of the same features (although the current
implementation does lack a few that were present in the original.)
In fact, one of the classes in this package, {@link cbil.csp.HTMLUtil}, is
generated by a Perl script that uses the HTML definition encoded in
the data structures of Perl CSP.  This class ({@link cbil.csp.HTMLUtil}) 
and a small utility class ({@link cbil.csp.AH}) form the basis of 
Java CSP.<p>

{@link cbil.csp.AH} is a small wrapper class that extends {@link java.util.Hashtable}.
It has a constructor that takes an array of objects.  The length of this
array must be even (and the class will throw an exception if it isn't.)
{@link cbil.csp.AH} simply provides an easy way to initialize a Hashtable in-line
in your Java source code.  It's essentially the Java analog of the Perl
syntax that allows you to turn an even-length array into a hash (in case
you hadn't figured it out already, the elements of the array alternate
between Hashtable keys and values.)  Here's an example of how you'd
create an instance of {@link cbil.csp.AH}:<p>

<PRE>
  AH size_plus1 = new AH(new String[] {"size", "+1"});
</PRE>

In this case, the Hashtable will have just one key, "size", and one value, 
"+1".  If you haven't used the original CSP, you can probably figure out
from the preceding example what these {@link cbil.csp.AH} objects are 
used for; as in Perl CSP (which used a more sophisticated subclass of 
a Perl hash), these hashtable-based objects store the attributes and values
associated with a particular HTML tag.  For example, <code>size_plus1</code>
could be used to supply the attributes for the HTML <code>FONT</code>
element in the following HTML fragment:<p>

<PRE>
&lt;FONT size="+1"&gt;Hello!&lt;/FONT&gt;
</PRE>

As in Perl CSP, Java CSP has another class ({@link cbil.csp.HTMLUtil}) that does
the job of generating HTML.  The class generates HTML one element at a time, and
to generate an element, it has to be told:

<OL>
<LI>What HTML element it should generate (e.g. &lt;H1&gt;, &lt;FONT&gt;, &lt;BR&gt;).</LI>
<LI>What attributes it should include (e.g. size="+1").</LI>
<LI>Whether it should generate one or both tags (e.g. &lt;FONT SIZE="+1"&gt;&lt;/FONT&gt 
versus simply &ltFONT SIZE="+1"&gt or &lt/FONT&gt.)</LI>
<LI>If both tags are to be generated, what should be put between them (e.g. "Hello!")</LI>
</OL>

And here's how you tell it each of these things:

<OL>
<LI>The HTML element is determined by which method of {@link cbil.csp.HTMLUtil} 
you call; it has methods called <code>FONT</code>, <code>BR</code>, and so on.</LI>
<LI>The attributes are specified by an instance of {@link cbil.csp.AH}, as we've
already seen.</LI>
<LI>The default is to generate both tags, but each method of {@link cbil.csp.HTMLUtil}
has a variant (with the same name) that takes two boolean values.  The first
boolean says whether to <b>omit</b> the first tag, and the second whether
to <b>omit</b> the second tag.</LI>
<LI>The elements that allow you to place content between the begin and end tags 
have methods in {@link cbil.csp.HTMLUtil} that take a String.  This String specifies what goes 
between the tags.  Since all the methods in {@link cbil.csp.HTMLUtil} return Strings, you can 
pass the results of one call to the input of another.</LI>
</OL>

<BR>
<A NAME = "examples"><b>EXAMPLE</b></A><BR><BR>

Here's the source code to an example program, {@link cbil.csp.Test cbil.csp.Test}.  
To run it or compile it for yourself you'll need to include the file 
<code>/usr/local/lib/java_classes/JCSP.jar</code> in your Java
<code>CLASSPATH</code>.

<PRE>
/**
 * Copyright (C) 1999 Trustees of the University of Pennsylvania
 *
 * Computational Biology and Informatics Laboratory (CBIL),
 * University of Pennsylvania Center for Bioinformatics (www.pcbi.upenn.edu)
 */

package cbil.csp;

/**
 * Test.java
 *
 * An example test program for the CSP package.<p>
 *
 * Created: Mon Mar 15 08:52:59 1999
 *
 * @author Jonathan Crabtree
 * @version
 */
public class Test {

    public static void main(String args[]) {

	// Create an instance of {@link cbil.csp.AH} to represent the
	// HTML attributes for a TEXTAREA we'lll be creating.
	// It will have 5 rows and 70 columns.
	//
	AH ta_args = new AH(new String[] {
	    "rows", "5",
	    "cols", "70"});

	// Print an HTML &lt;BR&gt; tag.  <code>AH.E</code> is a 
	// predefined static variable of the class {@link cbil.csp.AH}
	// that contains an "empty" instance of <code>csp.AH</code>.
        // It's the same as saying <code>new AH(new String[] {})</code>
	// but avoids creating a new object.
	//
	System.out.println(HTMLUtil.br(AH.E));

	// This does exactly the same: BR has no required attributes,	
	// so the <code>AH.E</code> can be omitted.  Notice also that
	// both <code>HTMLUtil.BR</code> and <code>HTMLUtil.br</code>
	// are valid method calls.  Uppercase and lowercase versions 
	// of all the HTML elements are valid.
	//
	System.out.println(HTMLUtil.BR());

	// Create an HTML TEXTAREA with the specified contents, using
	// the object <code>ta_args</code> we created earlier.
	//
	System.out.println(HTMLUtil.textarea(ta_args, "This is a test!"));

	// "Lazy" mode: here we're using the methods of {@link cbil.csp.HTMLUtil}
	// that let us print only the begin or end tag of an HTML element.
	// These methods have two extra boolean parameters that say whether
	// to omit the begin and end tags.  Any attributes are always printed 
	// in the begin tag.

	// Print the begin tag.
	//
	// The <code>false, true</code> means don't omit the begin tag
	// (omit = false) but do omit the end tag (omit = true).
	//
	System.out.print(HTMLUtil.textarea(ta_args, false, true));

	// Print the TEXTAREA's contents.
	//
	System.out.print("Testing lazy mode...");

	// Print the end tag.
	//
	// Here the first argument could be left out, or set to
	// <code>AH.E</code>, because attributes are only printed
	// with the begin tag.  Notice that the booleans are reversed
	// from the call to print the begin tag.
	//
	System.out.println(HTMLUtil.TEXTAREA(ta_args, true, false));
    }
}
</PRE>

<BR>
<A NAME = "issues"><b>KNOWN ISSUES</b></A><BR><BR>

<OL>
<LI>{@link cbil.csp.HTMLUtil} does not generate newlines.  This is in order to 
correctly generate elements such as &lt;PRE&gt;.  However, it makes it 
very difficult to read and debug output in a browser's Source window.  The
current workaround is to generate newlines in the code that invokes 
{@link cbil.csp.HTMLUtil}</LI>
<LI>The constructor to {@link cbil.csp.AH} takes an array of <code>Object</code>,
but {@link cbil.csp.HTMLUtil} expects instances of <code>AH</code> that contain
only <code>Strings</code>.</LI>
<LI>The Perl data structures from which {@link cbil.csp.HTMLUtil} was generated
were not complete; there are some legal combinations of attributes and HTML elements
that the program may erroneously flag as invalid.  Please report such cases if you
encounter them.
</OL>

<BR>
<i>March 18, 1999&nbsp;Jonathan Crabtree</i><BR>

<!-- hhmts start -->
Last modified: Fri Mar 19 17:31:24 EST 1999
<!-- hhmts end -->
</BODY>
